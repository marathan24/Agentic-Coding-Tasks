claude --verbose --output-format stream-json -p '
The current asynchronous processing pipeline suffers from race conditions due to the non-deterministic completion times of related items. This timing mismatch currently results in incomplete data structures and broken references between connected entities. Your task is to implement a robust synchronization logic that handles all possible execution orders to ensure data integrity. The solution must guarantee that connections between related items are eventually consistent, regardless of when individual components finish processing. Ensure the fix covers all edge cases and successfully validates against the provided test suite.' --allowedTools Bash Edit Write Read Glob Grep LS WebFetch NotebookEdit NotebookRead TodoRead TodoWrite Agent 2>&1 </dev/null | tee /logs/agent/claude-code.txt